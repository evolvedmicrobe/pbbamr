# This file was generated by Rcpp::compileAttributes
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

#' Load PBI BAM index file
#'
#' This function loads a pbi index file into a dataframe.  Depending on the
#' number of attributes present, it will either load just the basic data, or optionally
#' the mapping and barcode data.
#'
#' The original BAM file can also be read to gather additional covariates such as the SNR, read quality 
#' and number of passes, though this may take longer.
#'
#' @param filename The BAM file name (without .pbi)
#' @param loadSNR Should we load the four channel SNR data? (Default = FALSE)
#' @param loadNumPasses Should we load the number of passes data? (Default = FALSE)
#' @param loadRQ Shouold we load the read quality? (Default = FALSE)
#' @export
#' @examples loadpbi("~git/pbbam/tests/data/dataset/bam_mapping_1.bam.pbi")
loadpbi <- function(filename, loadSNR = FALSE, loadNumPasses = FALSE, loadRQ = FALSE) {
    .Call('pbbamr_loadpbi', PACKAGE = 'pbbamr', filename, loadSNR, loadNumPasses, loadRQ)
}

#' Load BAM alignments as a list of data frames.
#'
#' @param offsets The virtual file offsets to retrieve BAM records from (can be obtained from the index file based on loadpbi).
#' @param bamName The BAM file name to grab
#' @param indexedFastaName The name of the indexed fasta file this should come from.
#'
#' @return Returns a list of alignments as data frames.
#' @export
loadDataAtOffsets <- function(offsets, bamName, indexedFastaName) {
    .Call('pbbamr_loadDataAtOffsets', PACKAGE = 'pbbamr', offsets, bamName, indexedFastaName)
}

#' Load BAM alignments as a list of list for the HMM model.
#'
#' @param offsets The virtual file offsets to retrieve BAM records from (can be obtained from the index file based on loadpbi).
#' @param bamName The BAM file name to grab
#' @param indexedFastaName The name of the indexed fasta file this should come from.
#' @param trimToLength How much should we subsample the alignments? 
#'
#' @return Returns a list of phase2datasets as data frames.
#' @export
loadHMMfromBAM <- function(offsets, bamName, indexedFastaName, trimToLength = 140L) {
    .Call('pbbamr_loadHMMfromBAM', PACKAGE = 'pbbamr', offsets, bamName, indexedFastaName, trimToLength)
}

